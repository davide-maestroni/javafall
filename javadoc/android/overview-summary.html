<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_80) on Fri Aug 07 10:44:47 CEST 2015 -->
<title>Overview (Javadoc - jroutine-android)</title>
<meta name="date" content="2015-08-07">
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Overview (Javadoc - jroutine-android)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li class="navBarCell1Rev">Overview</li>
<li>Package</li>
<li>Class</li>
<li><a href="overview-tree.html">Tree</a></li>
<li><a href="deprecated-list.html">Deprecated</a></li>
<li><a href="index-all.html">Index</a></li>
<li><a href="help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev</li>
<li>Next</li>
</ul>
<ul class="navList">
<li><a href="index.html?overview-summary.html" target="_top">Frames</a></li>
<li><a href="overview-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 class="title">jroutine-android 4.4.0</h1>
</div>
<div class="header">
<div class="subTitle">
<div class="block"><a href="https://github.com/davide-maestroni/jroutine" target="_blank">Parallel programming on the go.</a></div>
</div>
<p>See: <a href="#overview_description">Description</a></p>
</div>
<div class="contentContainer">
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Packages table, listing packages, and an explanation">
<caption><span>Packages</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Package</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="com/gh/bmd/jrt/android/annotation/package-summary.html">com.gh.bmd.jrt.android.annotation</a></td>
<td class="colLast">
<div class="block">Android platform specific annotation definitions.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/gh/bmd/jrt/android/builder/package-summary.html">com.gh.bmd.jrt.android.builder</a></td>
<td class="colLast">
<div class="block">Android routine builder definitions.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="com/gh/bmd/jrt/android/core/package-summary.html">com.gh.bmd.jrt.android.core</a></td>
<td class="colLast">
<div class="block">Core classes and interfaces specific to the Android platform.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/gh/bmd/jrt/android/invocation/package-summary.html">com.gh.bmd.jrt.android.invocation</a></td>
<td class="colLast">
<div class="block">Invocation classes and interfaces specific to the Android platform.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="com/gh/bmd/jrt/android/log/package-summary.html">com.gh.bmd.jrt.android.log</a></td>
<td class="colLast">
<div class="block">Log classes specific to the Android platform.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/gh/bmd/jrt/android/routine/package-summary.html">com.gh.bmd.jrt.android.routine</a></td>
<td class="colLast">
<div class="block">Routine interfaces specific to the Android platform.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="com/gh/bmd/jrt/android/runner/package-summary.html">com.gh.bmd.jrt.android.runner</a></td>
<td class="colLast">
<div class="block">Runner related classes and definitions specific to the Android platform.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/gh/bmd/jrt/android/service/package-summary.html">com.gh.bmd.jrt.android.service</a></td>
<td class="colLast">
<div class="block">Android service classes implementation.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="com/gh/bmd/jrt/android/v11/core/package-summary.html">com.gh.bmd.jrt.android.v11.core</a></td>
<td class="colLast">
<div class="block">Routine interfaces and implementations specific to the Android platform.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/gh/bmd/jrt/android/v4/core/package-summary.html">com.gh.bmd.jrt.android.v4.core</a></td>
<td class="colLast">
<div class="block">Routine interfaces and implementations with support for Android compatibility library.</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="footer"><a name="overview_description">
<!--   -->
</a>
<div class="subTitle">
<div class="block"><a href="https://github.com/davide-maestroni/jroutine" target="_blank">Parallel programming on the go.</a>
<p>
    Android platform customization of the <a href="http://davide-maestroni.github.io/jroutine/javadoc/library" target="_blank">jroutine</a> library.
</p>
<p>
    The code below shows how it is possible to load an image from the network in a background thread, by letting handle automatically any change in the configuration.
</p>
<b>Example 1:</b> simple approach.
<p>
    Note that this approach is fairly naive, since it lets the framework retain the instance of the downloaded bitmap.<br/>
    A smarter implementation would involve the use of a dedicated cache.
</p>
<pre>
    <code>
        public class MainActivity extends Activity {

            private static final String IMAGE_URI = "http://...";

            &commat;Override
            protected void onCreate(final Bundle savedInstanceState) {

                super.onCreate(savedInstanceState);
                setContentView(R.layout.main_layout);

                try {

                    final ImageView imageView = (ImageView) findViewById(R.id.image);
                    JRoutine.on(RoutineContext.contextFrom(this), ClassToken.tokenOf(LoadBitmap.class))
                            .loaders()
                            .withCacheStrategy(CacheStrategyType.CACHE_IF_SUCCESS)
                            .set()
                            .asyncCall(new URI(IMAGE_URI))
                            .passTo(new TemplateOutputConsumer&lt;Bitmap&gt;() {

                                &commat;Override
                                public void onError(&commat;Nullable final Throwable error) {

                                    Toast.makeText(MainTestActivity.this, (error != null) ? error.getMessage()
                                            : "Cannot load image", Toast.LENGTH_LONG).show();
                                }

                                &commat;Override
                                public void onOutput(final Bitmap bitmap) {

                                    imageView.setImageBitmap(bitmap);
                                }
                            });

                } catch (final URISyntaxException ignored) {

                }
            }

            private static class LoadBitmap extends TemplateContextInvocation&lt;URI, Bitmap&gt; {

                &commat;Override
                public void onInput(final URI uri, &commat;Nonnull final ResultChannel&lt;Bitmap&gt; result) {

                    try {

                        final InputStream stream = uri.toURL().openConnection().getInputStream();
                        final Bitmap bitmap = BitmapFactory.decodeStream(stream);

                        if (bitmap != null) {

                            result.pass(bitmap);

                        } else {

                            result.abort();
                        }

                    } catch (final IOException e) {

                        throw new InvocationException(e);

                    } catch (final InterruptedException e) {

                        throw new InvocationInterruptedException(e);
                    }
                }
            }
        }
    </code>
</pre>
<b>Example 2:</b> load in a service.
<p>
    The above example can be slightly modified to make the real loading happen in a dedicated service.<br/>
    Note that the service might even run in a separate process, since the Bitmap class implements the Parcelable interface. However, keep in mind that, depending on the specific image size, the amount of serialized data might exceed the parcel limits.
</p>
<pre>
    <code>
        public class MainActivity extends Activity {

            private static final String IMAGE_URI = "http://...";

            &commat;Override
            protected void onCreate(final Bundle savedInstanceState) {

                super.onCreate(savedInstanceState);
                setContentView(R.layout.main_layout);

                try {

                    final ImageView imageView = (ImageView) findViewById(R.id.image);
                    JRoutine.on(RoutineContext.contextFrom(this), ClassToken.tokenOf(LoadBitmapFromService.class))
                            .loaders()
                            .withCacheStrategy(CacheStrategyType.CACHE_IF_SUCCESS)
                            .set()
                            .asyncCall(new URI(IMAGE_URI))
                            .passTo(new TemplateOutputConsumer&lt;Bitmap&gt;() {

                                &commat;Override
                                public void onError(&commat;Nullable final Throwable error) {

                                    Toast.makeText(MainTestActivity.this, (error != null) ? error.getMessage()
                                            : "Cannot load image", Toast.LENGTH_LONG).show();
                                }

                                &commat;Override
                                public void onOutput(final Bitmap bitmap) {

                                    imageView.setImageBitmap(bitmap);
                                }
                            });

                } catch (final URISyntaxException ignored) {

                }
            }

            private static class LoadBitmap extends TemplateContextInvocation&lt;URI, Bitmap&gt; {

                &commat;Override
                public void onInput(final URI uri, &commat;Nonnull final ResultChannel&lt;Bitmap&gt; result) {

                    try {

                        final InputStream stream = uri.toURL().openConnection().getInputStream();
                        final Bitmap bitmap = BitmapFactory.decodeStream(stream);

                        if (bitmap != null) {

                            result.pass(bitmap);

                        } else {

                            result.abort();
                        }

                    } catch (final IOException e) {

                        throw new InvocationException(e);

                    } catch (final InterruptedException e) {

                        throw new InvocationInterruptedException(e);
                    }
                }
            }

            private static class LoadBitmapFromService extends TemplateContextInvocation&lt;URI, Bitmap&gt; {

                private Routine&lt;URI, Bitmap&gt; mRoutine;

                &commat;Override
                public void onContext(&commat;Nonnull final Context context) {

                    super.onContext(context);
                    mRoutine = JRoutine.on(ServiceContext.serviceFrom(context, RoutineService.class),
                                           ClassToken.tokenOf(LoadBitmap.class))
                                       .buildRoutine();
                }

                &commat;Override
                public void onInput(final URI uri, &commat;Nonnull final ResultChannel&lt;Bitmap&gt; result) {

                    result.pass(mRoutine.asyncCall(uri));
                }
            }
        }
    </code>
</pre></div>
</div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li class="navBarCell1Rev">Overview</li>
<li>Package</li>
<li>Class</li>
<li><a href="overview-tree.html">Tree</a></li>
<li><a href="deprecated-list.html">Deprecated</a></li>
<li><a href="index-all.html">Index</a></li>
<li><a href="help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev</li>
<li>Next</li>
</ul>
<ul class="navList">
<li><a href="index.html?overview-summary.html" target="_top">Frames</a></li>
<li><a href="overview-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
