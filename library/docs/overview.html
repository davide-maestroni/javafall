<html>
<head>
    <title>javafall</title>
</head>
<body>
Cool and funny parallel programming.
<h2>Usage examples</h2>
<b>Example 1:</b> Root mean square:
<p>
The code below shows how it is possible to implement the computation of the root mean square of some input data, by distributing it in a predefined number of background threads.
</p>
<pre>
    <code>
        final float[] input;

        ...

        // Sequential

        double sum = 0;

        for (final float sample : input) {

            final double d = sample;
            sum += (d * d);
        }

        final double sRms = Math.sqrt(sum / input.length);

        // Parallel

        final Double pRms = (Double) fall().start()
                                            // Let the optimum number of threads be automatically computed
                                            .inBackground()
                                            // Equally distribute the load among them
                                            .distribute()
                                            // Compute the square of each sample
                                            .chain(Rapid.gateGenerator(new RapidGate() {

                                                public Double onSample(final Float sample) {

                                                    final double d = sample;
                                                    return (d * d);
                                                }

                                            }, this))
                                            // Merge the results in a single thread
                                            .inBackground(1)
                                            // Accumulate the sum and then calculate the square root mean
                                            .chain(new RapidGate() {

                                                private int mCount;

                                                private double mSum;

                                                public void onSquare(final Double square) {

                                                    mSum += square;
                                                    ++mCount;
                                                }

                                                public Double onComplete(final Flush ignored) {

                                                    return Math.sqrt(mSum / mCount);
                                                }

                                            })
                                            // Pull the input data along the flow...
                                            .pull(Drops.asObjects(input))
                                            // ...and finally collect the result
                                            .next();

        assert pRms == sRms;
    </code>
</pre>
</body>
</html>